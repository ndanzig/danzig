<!-- output file generated by BM Utilities -->
<html>

<p><a href="./3376fm.html"><img src="fm2html-toc.gif">Table of Contents</a>  <a href="3376c416.html#H754"><img src="fm2html-previous.gif">DOS</a><br>
<head>
<title>
TCP/IP Tutorial and Technical Overview
</title>
<body>

<h2><a name="bootp">4.17  BOOTstrap Protocol - BOOTP</a>
</h2>
<p><a name=index1897>BOOTP</a> is a <i>draft standard protocol</i>. Its status
is <i>recommended</i>. The BOOTP specifications can be found in <i>RFC 951  -
Bootstrap Protocol</i> and <i>RFC 1497 - BOOTP Vendor Information
Extensions</i>.
<p><a name=index1899>There</a> are also updates to BOOTP that allow it to
interoperate with DHCP (see <a href="3376c418.html#dhcp">Dynamic Host
Configuration Protocol (DHCP)</a>). <a name=index1900>These</a> are described
in <i>RFC 1542 - Clarifications and Extensions for the Bootstrap Protocol</i>
which updates RFC 951 and <i>RFC 1533 - DHCP Options and BOOTP Vendor
Extensions</i>, which obsoletes RFC 1497. <a name=index1902>These</a> updates
to BOOTP are <i>proposed standards</i> with a status of <i>elective</i>.
<p>LANs make it possible to use diskless hosts as workstations, routers,
terminal concentrators and so on. Diskless hosts require a mechanism to boot
remotely over a network. <a name=index1903>The</a> BOOTP protocol is used for
remote booting over IP networks. It allows a minimum IP protocol stack with no
configuration information, typically stored in ROM, to obtain enough
information to begin the process of downloading the necessary boot code. BOOTP
does not define how the downloading is done, but this process typically uses
TFTP (see also <a href="3376c43.html#tftp">Trivial File Transfer Protocol
(TFTP)</a>) as described in <i>RFC 906 - Bootstrap loading using TFTP</i>.
<p><a name=index1906>The</a> BOOTP process involves the following steps:
<ol>
<li>The client determines its own hardware address; this is normally in a ROM
on the hardware.
<li>A BOOTP client sends its hardware address in a UDP datagram to the server.
The full contents of this datagram are shown in
<a href="3376c417.html#figbootp">Figure - BOOTP Message Format</a>. If the
client knows its IP address and/or the address of the server, it should use
them, but in general BOOTP clients have no IP configuration data at all. If the
client does not know its own IP address, it uses 0.0.0.0. If the client does
not know the server's IP address, it uses the limited broadcast address
(255.255.255.255). The UDP port number is 67.
<li>The server receives the datagram and looks up the hardware address of the
client in its configuration file, which contains the client's IP address. The
server fills in the remaining fields in the UDP datagram and returns it to the
client using UDP port 68. One of three methods may be used to do this:
<ul>
<li>If the client knew its own IP address (it was included in the BOOTP
request), then the server returns the datagram directly to this address. It is
likely that the ARP cache in the server's protocol stack will not know the
hardware address matching the IP address. ARP will be used to determine it as
normal.
<li>If the client did not know its own IP address (it 0.0.0.0 in the BOOTP
request), then the server must concern itself with its own ARP cache. ARP on
the server cannot be used to find the hardware address of the client because
the client does not know its IP address and so cannot reply to an ARP request.
This is called the ``chicken and egg'' problem. There are two possible
solutions:
<ul>
<li>If the server has a mechanism for directly updating its own ARP cache
without using ARP itself, it does so and then sends the datagram directly.
<li>If the server cannot update its own ARP cache, it must send a broadcast
reply.
</ul>
</ul>
<li>When it receives the reply, the BOOTP client will record its own IP address
(allowing it to respond to ARP requests) and begin the bootstrap process.
</ol>
<br><br><a name=figbootp>
<img src="3376f148.gif"></a>
<br><i>Figure: BOOTP Message Format</i><br><br>
<dl>
<dt>
<a name=index1908>code</a>
<dd>Indicates  a request or a reply
<dl>
<dt>
1
<dd>Request
<dt>
2
<dd>Reply
</dl>
<dt>
HWtype
<dd>The type of hardware, for example:
<dl>
<dt>
1
<dd>Ethernet
<dt>
6
<dd>IEEE 802 Networks
</dl>
Refer to <i>STD 2 - Assigned Internet Numbers</i> for a complete list.
<dt>
length
<dd>Hardware address length in bytes. Ethernet and token-ring both use 6, for
example.
<dt>
hops
<dd>The client sets this to 0. It is incremented by a router which relays the
request to another server and is used to identify loops. RFC 951 suggests that
a value of 3 indicates a loop.
<dt>
Transaction ID
<dd>A random number used to match this boot request with the response it
generates.
<dt>
Seconds
<dd>Set by the client. It is the elapsed time in seconds since the client
started its boot process.
<dt>
Flags Field
<dd>The most significant bit of the flags field is used as broadcast flag. All
other bits must be set to zero; they are reserved for future use. Normally,
BOOTP servers attempt to deliver BOOTREPLY messages directly to a client using
unicast delivery. The destination address in the IP header is set to the BOOTP
<i>your IP address</i> and the MAC address is set to the BOOTP <i>client
hardware address</i>. If a host is unable to receive a unicast IP datagram
until it knows its IP address, then this broadcast bit must be set to indicate
the server that the BOOTREPLY must be sent as an IP and MAC broadcast.
Otherwise this bit must be set to zero.
<dt>
Client IP address
<dd>Set by the client. Either its known IP address, or 0.0.0.0.
<dt>
Your IP Address
<dd>Set by the server if the Client IP address field was 0.0.0.0.
<dt>
Server IP address
<dd>Set by the server.
<dt>
Router IP address
<dd>Set by the forwarding router if BOOTP forwarding is being used.
<dt>
Client hardware address
<dd>Set by the client and used by the server to identify which registered
client is booting.
<dt>
Server host name
<dd>Optional server host name terminated by X'00'.
<dt>
Boot file name
<dd>The client either leaves this null or specifies a generic name, such as
``router'' indicating the type of boot file to be used. The server returns the
fully qualified filename of a boot file suitable for the client. The value is
terminated by terminated by X'00'.
<dt>
Vendor-specific area
<dd>Optional vendor-specific area. It is recommended that clients always fill
the first four bytes with a ``magic cookie''. If a vendor-specific ``magic
cookie'' is not used the client should use 99.130.83.99 followed by an end tag
(255) and set the remaining bytes to zero. Please see RFC 1533 for details.
</dl>
<p>One restriction with this scheme is the use of the limited broadcast address
for BOOTP requests; it requires that the server is on the same subnet as the
recipient. BOOTP forwarding is a mechanism for routers to forward BOOTP
requests. It is a configuration option available on some routers, including the
IBM 6611 and 2210 Network Processors. <a name=index1911>See</a> RFC 951 for
more information about BOOTP forwarding.
<p>Once the BOOTP client has processed the reply, it may proceed with the
transfer of the boot file and execute the full boot process. See RFC 906 for
the specification of how this is done with TFTP. The full boot process will
replace the minimum IP protocol stack used by BOOTP and TFTP by a normal IP
protocol stack transferred as part of the boot file and containing the correct
customization for the client.

<h3><a name="H757">4.17.1  Implementations</a>
</h3>

<h4><a name="H758">4.17.1.1  AIX/6000</a>
</h4>
<p><a name=index1912>The</a> BOOTP server function is implemented in the
<i>bootpd</i> daemon. This daemon is a subserver controlled by the inetd
superdaemon. Bootpd searches the <i>/etc/bootptab</i> file for hardware
addresses. For details on the file format, please refer to the online
InfoExplorer.
<p>The BOOTP client function is used in conjunction with TFTP to load
executable modules (X stations, diskless workstations) or configuration files
(intelligent hubs, routers) automatically at system startup.
<p><b>Note:</b> BOOTP requests from a BOOTP client are not able to pass an IP
router if not explicitly customized.

<h4><a name="H759">4.17.1.2  OS/2</a>
</h4>
<p>Both client and server functions are provided.
<ul>
<li>Server function: The BOOTPD command starts the server. When the BOOTP
server receives the hardware address it looks for a match in the /ETC/BOOTPTAB
file. Upon finding a matching hardware address, the server sends back (in the
UDP packet) an internet address, a subnet mask, and other information to the
client. Please refer to <i>IBM TCP/IP Version 2.0 for OS/2: User's Guide</i>
for more details about the /ETC/BOOTTAB file. BOOTP broadcast packets are used
for transfer and reside only on the local network. They do not pass through a
router to another network.
<li>Client function: the BOOTP command starts the client. The client will
execute and print out the response from the server as soon as the connection is
made.
</ul>

<h4><a name="H760">4.17.1.3  DOS</a>
</h4>
<p>TCP/IP for DOS provides the BOOTP client function. The BOOTP command
initiates this client function which can be very useful in establishing SLIP
connections (since BOOTP can be used to assign your IP address, you do not need
to know the IP address before the connection is made).

<p><a href="./3376fm.html"><img src="fm2html-toc.gif">Table of Contents</a>  <a href="3376c418.html#dhcp"><img src="fm2html-next.gif">Dynamic
Host Configuration Protocol (DHCP)</a><br>
</html>
