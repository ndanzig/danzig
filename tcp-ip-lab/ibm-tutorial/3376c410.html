<!-- output file generated by BM Utilities -->
<html>

<p><a href="./3376fm.html"><img src="fm2html-toc.gif">Table of Contents</a>  <a href="3376c49.html#H627"><img src="fm2html-previous.gif">OS/2</a><br>
<head>
<title>
TCP/IP Tutorial and Technical Overview
</title>
<body>

<h2><a name="rpc">4.10  Remote Procedure Call (RPC)</a>
</h2>
<br><br><a name=figrpc1>
<img src="3376rpc.gif"></a>
<br><i>Figure: Remote Procedure Call (RPC)</i><br><br>
<p>Sun-RPC is a <i>proposed standard protocol</i>. Its status is
<i>elective</i>.
<p>Remote Procedure Call is a standard developed by SUN Microsystems and used
by many vendors of UNIX systems. The current Sun-RPC specification can be found
in <i>RFC 1057 - RPC: Remote Procedure Call Protocol Specification Version
2</i><a name=index1717>.</a>
<p><a name=index1718>The</a> Remote Procedure Call protocol is an application
programming interface (API) available for developing distributed applications.
It allows programs to call subroutines that are executed at a remote system.
The caller program (called a <i>client</i>) sends a <i>call message</i> to the
<i>server process</i>, and waits for a <i>reply message</i>. The call message
includes the procedure's parameters and the reply message contains the
procedure's results.
<p>Sun RPC consists of the following parts:
<ul>
<li><i>RPCGEN</i>: <a name=index1719>a</a> compiler that takes the definition
of a remote procedure interface, and generates the client stubs and the server
stubs.
<li><i>XDR (eXternal Data Representation)</i>: <a name=index1720>a</a> standard
way of encoding data in a portable fashion between different systems. It
imposes a big-endian byte ordering and the minimum size of any field is 32
bits. This means that both the client and the server have to perform some
translation.
<li>A run-time library.
</ul>

<h3><a name="H630">4.10.1  RPC Concept</a>
</h3>
<p><a name=index1721>The</a> RPC concept can be simplified as follows:
<ul>
<li>The caller process sends a call message and waits for the reply.
<li>On the server side a process is dormant awaiting the arrival of call
messages. When one arrives, the server process extracts the procedure
parameters, computes the results and sends them back in a reply message.
</ul>
See <a href="3376c410.html#figrpcconc">Figure - RPC</a> for a conceptual model
of RPC.
<p>This is only a possible model, as the SUN RPC protocol doesn't put
restrictions on the concurrency model. In the model above, the caller's
execution blocks until a reply message is received. Other models are possible;
for instance, the caller may continue processing while waiting for a reply, or
the server may dispatch a separate task for each incoming call so that it
remains free to receive other messages.
<p>The remote procedure calls differ from local procedure calls in the
following ways:
<ul>
<li>Use of global variables as the server has no access to the caller program's
address space.
<li>Performance may be affected by the transmission times.
<li>User authentication may be necessary.
<li>Location of server must be known.
</ul>
<br><br><a name=figrpcconc>
<img src="3376f126.gif"></a>
<br><i>Figure: RPC</i> - Remote Procedure Call Model<br><br>

<h4><a name="H632">4.10.1.1  Transport</a>
</h4>
<p><a name=index1722>The</a> RPC protocol can be implemented on any transport
protocol. In the case of TCP/IP, it can use either TCP or UDP as the transport
vehicle. The type of the <i>transport</i> is a parameter of the RPCGEN command.
In case UDP is used, remember that this does not provide reliability, so it
will be up to the caller program itself to ensure this (using timeouts and
retransmissions, usually implemented in RPC library routines). Note that even
with TCP, the caller program still needs a timeout routine to deal with
exceptional situations such as a server crash.
<p>The call and reply message data is formatted to the XDR standard.

<h4><a name="H633">4.10.1.2  RPC Call Message</a>
</h4>
<a name=index1723>The</a> RPC call message consists of several fields:
<ul>
<li>Program and procedure numbers
<p>Each call message contains three fields (unsigned integers):
<ul>
<li>Remote program number
<li>Remote program version number
<li>Remote procedure number
</ul>
that uniquely identify the procedure to be executed. The remote program number
identifies a functional group of procedures, for instance a file system, which
would include individual procedures like "read" and "write". These individual
procedures are identified by a unique procedure number within the remote
program. As the remote program evolves, a version number is assigned to the
different releases.
<p>Each remote program is attached to an internet port. The number of this port
can be freely chosen, except for the reserved "well-known-services" port
numbers. It is evident that the caller will have to know the port number used
by this remote program.
<p>Assigned program numbers:
<dl>
<dt>
00000000 - 1FFFFFFF
<dd>defined by Sun
<dt>
20000000 - 3FFFFFFF
<dd>defined by user
<dt>
40000000 - 5FFFFFFF
<dd>transient (temporary numbers)
<dt>
60000000 - FFFFFFFF
<dd>reserved
</dl>
<li>Authentication fields
<p>Two fields, <i>credentials</i> and <i>verifier</i>, are provided for the
authentication of the caller to the service. It is up to the server to use this
information for user authentication. Also, each implementation is free to
choose the varieties of supported authentication protocols. Some authentication
protocols are:
<ul>
<li>Null authentication.
<li>UNIX authentication. The callers of a remote procedure may identify
themselves as they are identified on the UNIX system.
<li>DES authentication. In addition to user ID, a timestamp field is sent to
the server. This timestamp is the current time, enciphered using a key known to
the caller machine and server machine only (based on the <i>secret key</i> and
<i>public key</i> concept of DES).
</ul>
<li>Procedure parameters
<p>Data (parameters) passed to the remote procedure.
</ul>

<h4><a name="H634">4.10.1.3  RPC Reply Message</a>
</h4>
<p><a name=index1724>Several</a> replies exist, depending on the action taken:
<ul>
<li>SUCCESS: procedure results are sent back to the client.
<li>RPC_MISMATCH: server is running another version of RPC than the caller.
<li>AUTH_ERROR: caller authentication failed.
<li>PROG_MISMATCH: if program is unavailable or if the version asked for does
not exist or if the procedure is unavailable.
</ul>
<p>For a detailed description of the call and reply messages, see <i>RFC 1057 -
RPC: Remote Procedure Call Protocol Specification Version
2</i><a name=index1725>,</a> which also contains the type definitions (typedef)
for the messages in XDR language.

<h4><a name="portmap">4.10.1.4  Portmap or Portmapper</a>
</h4>
<p><a name=index1726>As</a> stated above, the caller has to know the exact port
number used by a specific RPC program to be able to send a call message to it.
Portmap is a server application that will map a program number and its version
number to the internet port number used by the program. Because Portmap
<a name=index1727>is</a> assigned a reserved (<i>well-known service</i>) port
number 111, all the caller has to do is ask the Portmap service on the remote
host about the port used by the desired program. See
<a href="3376c410.html#figportm">Figure - Portmap</a>.
<p>Portmap only knows about RPC programs on the host it runs on (only RPC
programs on the local host).
<p>In order for Portmap to know about the RPC program, every RPC program should
register itself with the local Portmap when it starts up. It should also cancel
its registration when it closes down.
<p>Normally, the calling application would contact Portmap on the destination
host to obtain the correct port number for a particular remote program, and
then send the call message to this particular port. A variation exists when the
caller also sends the procedure data along to Portmap and then the remote
Portmap directly invokes the procedure.
<br><br><a name=figportm>
<img src="3376f127.gif"></a>
<br><i>Figure: Portmap</i> - Informs the caller which port number a program on
its host occupies.<br><br>

<h4><a name="H637">4.10.1.5  RPCGEN</a>
</h4>
<p><a name=index1728>RPCGEN</a> is a tool that generates C code to implement an
RPC protocol. The input to RPCGEN is a file written in a language similar to C,
known as the RPC language. Assuming that an input file named <i>proto.x</i> is
used, RPCGEN produces the following output files:
<ul>
<li>A header file called <i>proto.h</i> that contains common definitions of
constants and macros
<li>Client stub source file, <i>protoc.c</i>
<li>Server stub source file, <i>protos.c</i>
<li>XDR routines source file, <i>protox.c</i>
</ul>

<h3><a name="H638">4.10.2  Implementations</a>
</h3>

<h4><a name="H639">4.10.2.1  VM</a>
</h4>
<p><a name=index1729>VM</a> provides an RPC application programming interface
(API) for both the client and the server side.
<p>For the client side, there are calls to:
<ul>
<li>Invoke (send) a remote procedure call.
<li>Query the remote Portmap application about ports.
</ul>
<p>For the server side, there are calls to:
<ul>
<li>Attach the program to a port number.
<li>Register the program and its port number with the local Portmap
application.
<li>Cancel registration with Portmap.
<li>Send a reply back to the caller.
</ul>
<p>This programming interface is available for programs written in the C
language. In addition to this, the XDR type definitions are shipped with the
product, in the form of C header files.
<p>The <i>rpcinfo</i> command can be used to display the list of currently
active RPC server programs on a host.

<h4><a name="H640">4.10.2.2  MVS</a>
</h4>
<p>MVS TCP/IP provides the same RPC support as VM TCP/IP.

<h4><a name="H641">4.10.2.3  OS/400</a>
</h4>
<p>The RPC programming interface is included in the licensed program offering
DCE Base Services/400 Version 3.
<p>The RPC facility consists of an application development tool and a runtime
library. When developing a DCE application, you simply define an RPC interface
between the client application and the server application. DCE uses the DCE
interface definition language (IDL) to define this interface. The language is
similar to ANSI C definitions. The application development tool consists of an
IDL compiler that compiles your interface definitions into portable C-language
source code. This IDL-generated source code can be compiled with your
application code using the ILE C compiler and linked to the DCE runtime library
to form the distributed application.
<p>To allow RPC to participate in an open distributed computing environment,
the RPC interface must be uniquely identified. This is accomplished by  giving
the interface a universal unique identifier (UUID). A UUID is a hexadecimal
number that contains information that makes it unique from all other UUIDs. The
application development tool also includes a UUID generator that generates and
automatically includes a UUID in the RPC interface description.
<p>The runtime service implements the network protocols by which the client and
server sides of an application communicate.

<h4><a name="H642">4.10.2.4  AIX/6000</a>
</h4>
<p>Full client and server RPC functions are available in AIX/6000.
<p>The following programming interfaces are available:
<ul>
<li>RPCGEN protocol compiler.
<li>High layer interface - This interface is actually a method for using RPC
routines, rather than a part of RPC proper. An example is <i>rnusers()</i>.
<li>Middle layer interface - This interface is RPC proper. That is, the
programmer only needs to make RPC calls, but need not consider details about
sockets or other low-level implementation mechanisms. On this interface, RPC
does not allow timeout specifications, choice of transport, or process control
in case of errors. Nor does it support multiple types of call authentication.
Example routines are <i>registerrpc(),callrpc()</i> and <i>svc_run()</i>.
<li>Low layer interface - This interface allows the programmer greatest control
but also requires more low-level coding efforts. This interface may be
necessary if for example, the programmer needs to use TCP instead of UDP (used
by the two higher layers). Example routines are <i>svctcp_create() and
clnt_call()</i>.
</ul>
<p>For details about the RPC programming interface for AIX, see the
documentation available for each implementation and <i>AIX Distributed
Environments</i>, GG24-3489.

<h4><a name="H643">4.10.2.5  AIX/ESA</a>
</h4>
<p>Full RPC client and server functions are provided in the AIX/ESA
environment.

<h4><a name="H644">4.10.2.6  OS/2</a>
</h4>
<p>Full RPC client and server functions are provided in the OS/2 environment.

<h4><a name="H645">4.10.2.7  DOS</a>
</h4>
TCP/IP for DOS provides full RPC client functionality.

<p><a href="./3376fm.html"><img src="fm2html-toc.gif">Table of Contents</a>  <a href="3376c411.html#ncs"><img src="fm2html-next.gif">Network
Computing System (NCS)</a><br>
</html>
