<!-- output file generated by BM Utilities -->
<html>

<p><a href="./3376fm.html"><img src="fm2html-toc.gif">Table of Contents</a>  <a href="3376c43.html#H448"><img src="fm2html-previous.gif">DOS</a><br>
<head>
<title>
TCP/IP Tutorial and Technical Overview
</title>
<body>

<h2><a name="ftp">4.4  File Transfer Protocol (FTP)</a>
</h2>
<br><br><a name=figftp1>
<img src="3376ftp.gif"></a>
<br><i>Figure: File Transfer Protocol (FTP)</i><br><br>
<p>FTP is a <i>standard protocol</i> with STD Number 9.
<a name=index1459>Its</a> status is <i>recommended</i>. It is described in
<i>RFC 959 - File Transfer Protocol (FTP)</i>.
<p><a name=index1461>Copying</a> files from one machine to another is one of
the most frequently used operations. The data transfer between client and
server can be in either direction. The client may send a file to the server
machine. It may also request a file from this server.
<p>To access remote files, the user must identify himself to the server. At
this point the server is responsible for authenticating the client before it
allows the file transfer.
<p>From an FTP user's point of view, the link is connection-oriented. In other
words, it is necessary to have both hosts up and running TCP/IP to establish a
file transfer.

<h3><a name="H451">4.4.1  Overview of FTP</a>
</h3>
FTP uses TCP as a transport protocol to provide reliable end-to-end
connections. Two connections are used: the first is for login and follows the
TELNET protocol and the second is for managing the data transfer. As it is
necessary to log into the remote host, the user must have a user name and a
password to access files and directories. The user who initiates the connection
assumes the client function, while the server function is provided by the
remote host.
<p>On both sides of the link the FTP application is built with a protocol
interpreter (PI), a data transfer process (DTP), and a user interface (see
<a href="3376c44.html#figftp">Figure - FTP Principle</a>).
<p>The user interface communicates with the protocol interpreter, which is in
charge of the control connection. This protocol interpreter has to communicate
the necessary information to its own file system.
<p>On the opposite side of the link, the protocol interpreter, besides its
function of responding to the TELNET protocol, has to initiate the data
connection. During the file transfer, the data management is performed by DTPs.
After a user's request is completed, the server's PI has to close the control
connection.
<br><br><a name=figftp>
<img src="3376f105.gif"></a>
<br><i>Figure: FTP Principle</i><br><br>

<h3><a name="H453">4.4.2  FTP Operations</a>
</h3>
<a name=index1462>When</a> using FTP, the user will perform some or all of the
following operations:
<ul>
<li>Connect to a remote host
<li>Select a directory
<li>List files available for transfer
<li>Define the transfer mode
<li>Copy files to or from the remote host
<li>Disconnect from the remote host
</ul>

<h4><a name="H454">4.4.2.1  Connect to the Remote Host</a>
</h4>
<p><a name=index1464>To</a> execute a file transfer, the user begins by logging
into the remote host. This is the primary method of handling the security. The
user must have a user ID and password for the remote host, unless using
Anonymous FTP which is described in <a href="3376c44.html#anon">Anonymous
FTP</a>.
<p>There are three commands which are used:
<dl>
<dt>
Open
<dd><a name=index1465>Selects</a> the remote host and initiates the login
session
<dt>
User
<dd><a name=index1466>Identifies</a> the remote user ID
<dt>
Pass
<dd><a name=index1467>Authenticates</a> the user
<dt>
Site
<dd><a name=index1468>Sends</a> information to the foreign host that is used to
provide services specific to that host
</dl>

<h4><a name="H455">4.4.2.2  Select a Directory</a>
</h4>
<p><a name=index1470>When</a> the control link is established, the user may use
the cd (change directory) subcommand to select a remote directory to work with.
Obviously, user can only access directories for which the remote user ID has
the appropriate authorization. The user may select a local directory with the
lcd (local change directory) command. The syntax of theses commands depends
upon the operating system in use.

<h4><a name="H456">4.4.2.3  List Files Available for Transfer</a>
</h4>
<p><a name=index1472>This</a> is done using the dir or ls subcommands.

<h4><a name="H457">4.4.2.4  Specifying the Transfer Mode</a>
</h4>
<p>Transferring data between dissimilar systems often requires transformations
of the data as part of the transfer process. The user has to decide on two
aspects of the data handling:
<ul>
<li>The way the bits will be moved from one place to another.
<li>The different representations of data upon the system's architecture.
</ul>
<p>This is controlled using two subcommands:
<dl>
<dt>
<a name=index1474>Mode</a>
<dd>Specifies whether the file is to be treated as having a record structure in
a byte stream format.
<dl>
<dt>
Block
<dd>Logical record boundaries of the file are preserved.
<dt>
Stream
<dd>The file is treated as a byte stream. This is the default, and provides
more efficient transfer but may not produce the desired results when working
with a record-based file system.
</dl>
<dt>
Type
<dd>Specifies the character sets used for the data.
<dl>
<dt>
ASCII
<dd>Indicates that both hosts are ASCII-based, or that if one is ASCII-based
and the other is EBCDIC-based, that ASCII-EBCDIC translation should be
performed.
<dt>
EBCDIC
<dd>Indicates that both hosts use an EBCDIC data representation.
<dt>
Image
<dd>Indicates that data is to be treated as contiguous bits packed in 8-bit
bytes.
</dl>
</dl>
<p>Because these subcommands do not cover all possible differences between
systems, the SITE subcommand is available to issue implementation-dependent
commands.

<h4><a name="H458">4.4.2.5  Copy Files</a>
</h4>
<dl>
<dt>
<a name=index1476>Get</a>
<dd>Copies a file from the remote host to the local host.
<dt>
Put
<dd>Copies a file from the local host to the remote host.
</dl>

<h4><a name="H459">4.4.2.6  End the Transfer Session</a>
</h4>
<dl>
<dt>
<a name=index1479>Quit</a>
<dd>Disconnects from the remote host and terminates FTP. Some implementations
use the BYE subcommand.
<dt>
Close
<dd>Disconnects from the remote host but leaves the FTP client running. An open
command may be issued to work with a new host.
</dl>

<h3><a name="H460">4.4.3  Reply Codes</a>
</h3>
<p><a name=index1480>In</a> order to manage these operations, the client and
server conduct a dialog  using the TELNET convention. The client issues
commands, and the server responds with <i>reply codes</i>. The responses also
include comments for the benefit of the user, but the client program uses only
the codes.
<p>Reply codes are three digits long, with the first digit being the most
significant. <br><br>
<a name=tabftpcode><img src=3376t17.gif></a><br>
<i>Table: FTP Reply Codes</i> - The second and third digits provide more
details about the response.<br><br>

<h5><a name="H462">Example</a>
</h5>
<p>For each user command, shown like <tt><b>this</b></tt>, the FTP server
responds with a message beginning with a 3-digit reply code, shown like
<tt>this</tt>:
<pre>
<b>FTP foreignhost</b>
220 service ready
<b>USERNAME cms01</b>
331 user name okay
<b>PASSWORD xyxyx</b>
230 user logged in
<b>TYPE Image</b>
200 command okay

</pre>

<h3><a name="H463">4.4.4  FTP Scenario</a>
</h3>
<p><a name=index1481>A</a> LAN user has to transfer a file from his workstation
to a system running VM. The file has to be transferred from his disk to the
minidisk 191 owned by the CMS's user cms01. There is no Resource Access Control
Facility (RACF) installed. The symbolic name corresponding to an Internet
address is host01.itsc.raleigh.ibm.com.
<br><br><a name=figftps>
<img src="3376f106.gif"></a>
<br><i>Figure: FTP Scenario</i><br><br>

<h3><a name="H465">4.4.5  A Sample FTP Session</a>
</h3>
<br><br><a name=figftpsamp>
<hr><pre>
[C:\SAMPLES]<b>ftp host01.itsc.raleigh.ibm.com</b>
Connected to host01.itsc.raleigh.ibm.com.
220 host01 FTP server (Version 4.1 Sat Nov 23 12:52:09 CST 1991) ready.
Name (rs60002): <b>cms01</b>
331 Password required for cms01.
Password: <b>xxxxxx</b>
230 User cms01 logged in.
ftp&gt; <b>put file01.tst file01.tst</b>
200 PORT command successful.
150 Opening data connection for file01.tst (1252 bytes).
226 Transfer complete.
local: file01.tst remote: file01.tst
1285 bytes received in 0.062 seconds (20 Kbytes/s)
ftp&gt; <b>close</b>
221 Goodbye.
ftp&gt; <b>quit</b>
</pre>
<hr><i>Figure: A Sample FTP Session</i> - Transfer a file to a remote
host<br><br>

<h4><a name="anon">4.4.5.1  Anonymous FTP</a>
</h4>
<p><a name=index1482>Many</a> TCP/IP sites implement what is known as
<i>anonymous FTP</i>, which means that these sites allow public access to some
file directories. The remote user only needs to use the login name
<i>anonymous</i> and password <i>guest</i> or some other common password
conventions, for example the user's Internet E-mail ID. The password convention
used on a system is explained to the user during the login process.

<h3><a name="H468">4.4.6  Implementations</a>
</h3>

<h4><a name="H469">4.4.6.1  VM</a>
</h4>
<p><a name=index1484>TCP/IP</a> for VM is implemented with server and client
functions of FTP. This implementation provides you with most of the
capabilities useful for file transfer. Please refer to <i>IBM TCP/IP Version 2
Release 3 for VM: User's Guide</i> for a list of the subcommands that may be
used.
<p>The file transfer process can be automated using the EXEC interface which
allows you to read the FTP subcommands from a file (using the FILEDEF command)
or from the program stack. By default, the results of your FTP dialog are
printed on your terminal. A file may be defined as the output device for the
FTP dialog using the FILEDEF command, in which case the dialog output is placed
in the file rather than typed on the console. Please refer to the <i>IBM TCP/IP
Version 2 Release 3 for VM: User's Guide</i> for more information about the
EXEC interface.
<p>While in an FTP session you can issue CMS commands on your local (client) VM
system.
<p>The Resource Access Control Facility (RACF) allows FTP servers to act as
<i>surrogates</i> for other user IDs. This means that the FTP server can access
those disks available to that user ID (the one entered during the logon
procedure). Please refer to <i>IBM TCP/IP Version 2 Release 3 for VM: Planning
and Customization</i> for more information about RACF considerations.

<h4><a name="ftpjob">4.4.6.2  MVS</a>
</h4>
<p>TCP/IP for MVS is implemented with both server and client functions of FTP.
This implementation provides you with most of the capabilities useful for file
transfer. Please refer to <i>IBM TCP/IP Version 3 Release 1 for MVS: User's
Guide</i> for a list of the subcommands that may be used.
<p>There are two FTP servers available in MVS:
<ul>
<li>The old Pascal-based FTP server (module FTPSERVE)
<li>The new C-based FTP server (module EZAFTSRV), which is recommended
</ul>
<p>The C FTP Server provides an FTP server specifically designed for MVS
TCP/IP. In addition to providing all the functions found in the Pascal-based
FTP server (except RDW), C FTP Server uses native MVS file interfaces; has a
structured design; takes advantage of MP support, reducing the need for
multiple servers; improves the RAS characteristics for FTP server; adds
struct-r support; provides delete/catalog options if file transfer fails.  The
C FTP Server is available in an MVS/ESA environment only.
<p>The C FTP Server will be the basis for future enhancements of the FTP
server.  No enhancements are planned for the Pascal server in further releases.

<h5><a name="H471">SQL Query to DB2</a>
</h5>
<p><a name=index1486>MVS</a> FTP also supports the DATABASE 2 (DB2) SQL query
function. Only the <i>SELECT</i> DML operation is supported. That is, other DML
(INSERT, UPDATE or DELETE) and DDL operations are not supported. The SQL query
may be submitted to a DB2 subsystem at either the local or the remote site, as
illustrated below:
<ol>
<li><i>put</i> (submit) a local file containing an <i>SQL query</i> to any DB2
subsystem at the <i>remote</i> MVS FTP server and <i>get</i> (retrieve) the SQL
query results in a file from the remote MVS FTP server
<li><i>put</i> a local file containing an SQL query to any DB2 subsystem at the
<i>local</i> MVS FTP client; upon completion of the query operation, the local
MVS FTP client will transfer the SQL query output file to the remote FTP server
</ol>
The <i>site</i> and <i>locsite</i> FTP subcommands are used to switch the
<i>filetype</i> to <i>sql</i> and to identify the name of the DB2 subsystem.
Please refer to <i>IBM TCP/IP Version 3 Release 1 for MVS: User's Guide</i> for
the syntax of these FTP subcommands.
<p>An FTP installation may also have the flexibility of defining the following
user security exits: Check IP and PORT Addresses, Check USER and PASSWORD,
Check the Command, and Check use of JES.
<p>The FTP server also provides <i>user accounting</i> and <i>control
information</i> using the MVS <i>SMF</i> (System Management Facility) records.
For example, client identity, IP addresses, used commands and failed logon
attempts can be recorded.
<p>IBM TCP/IP for MVS uses SMF record type 118 for all SMF records.
<p>The file transfer process can be automated using the EXEC interface that
allows you to read the FTP subcommands from a disk (<i>ALLOC DA(FTPIN)
DD(INPUT) SHR REU</i>) or from a program stack (<i>QUEUE </i> command). As the
default, the results of your FTP dialog are printed on your terminal. If a disk
file is defined as the output device (<i>ALLOC DA(FTPOUT) DD(OUTPUT) SHR REU
</i>), the dialog results go into the file. Please refer to the <i>IBM TCP/IP
Version 3 Release 1 for MVS: User's Guide</i> for more information about the
EXEC interface. You can also run FTP as a batch job, but you must supply the
JCL and submit it as a job with TSO job submission facility.
<p>While in an FTP session you can issue TSO commands on your local (client)
MVS system.

<h5><a name="H472">Job Submission via JES</a>
</h5>
<p>The MVS FTP server allows you to interface with MVS Job Entry System (JES).
First an FTP session must be established between the client and the FTP MVS
server (The SET FILETYPE=JES command activates the JES interface).
<p>The FTP server provides four functions in its JES interface:
<ol>
<li><a name=index1487>Submit</a> a job. The JCL is created on the client and
sent to the MVS server using FTP.
<li>Display the status of all the user's jobs.
<li>Receive the spool output of the job (JCL messages and SYSOUT). Automatic
return of JES output to the FTP client is possible.
<li>Delete a job.
</ol>
<p>Please refer to <i>IBM TCP/IP Version 3 Release 1 for MVS: Customization and
Administration Guide</i> for more information about the JES interface.

<h5><a name="H473">Special SITE parameters for transferring files between two
MVS systems</a>
</h5>
<ul>
<li>Data Compression as defined in RFC 959
<p>Data is transmitted in a compressed format.
<li>Checkpoint and Restart as defined in RFC 959
</ul>
<p>Both the block and the compressed transfer mode supports checkpoint/restart.
When checkpointing is used, the sending side inserts checkpoint markers into
the data being transmitted. Now assume that your connection breaks down in the
middle of the transfer of a large file. All you have to do now is to start the
FTP client again, reconnect to the server, reestablish your mode and type
settings, and issue the restart command.

<h4><a name="H474">4.4.6.3  OS/400</a>
</h4>
<p>Both the FTP client and server functions are supported in OS/400.
<p>FTP supports the following functions:
<ul>
<li>Creating libraries, files, and members using the OS/400 FTP server
subcommands.
<p>Since the FTP protocol limits remote FTP server subcommand names to 4
characters or less, the OS/400 FTP server supports abbreviated AS/400 CL
commands. For example, CRTL is the abbreviated subcommand for CRTLIB
<li>Using ASCII and EBCDIC mapping tables for AS/400 servers and FTP clients to
map incoming and outgoing data.
<li>Running FTP unattended in batch mode by using either a REXX EXEC or a CL
program.
<li>Submitting and accepting remote CL commands.
<li>Transferring binary files without changes.
<li>Sending document files in EBCDIC format or translating them to ASCII (the
default format).
<li>Converting double-byte character set (DBCS) data from AS/400 EBCDIC code
pages to and from internet ASCII code pages.
<li>Sending or receiving physical files, source files, logical files, save
files, hierarchical file system files (HFS), including Client Access/400 files
and document library object (DLO) files.
<li>Sending or receiving files greater than 16 million bytes.
</ul>
<p>The FTP client can be started with the FTP or the STRCPFTP command. OS/400
files must be specified in the following format (otherwise, the default may not
be the name you expect or want):
<p><tt>{Libraryname/}Filename.membername</tt>

<h4><a name="H475">4.4.6.4  AIX/6000</a>
</h4>
<p>AIX/6000 provides a full implementation of FTP. It supports the standard set
of subcommands with the addition of NLIST, RSTATUS, RHELP, SIZE and SYSTEM.
Both the client and server functions are supported, via the ftp and the ftpd
programs, respectively.
<p>The ftpd server (also known as a daemon) is a subserver controlled by the
inetd subsystem (also known as the super daemon).
<p>The $HOME/.netrc file can be used to specify automatic login information for
the user ID and password to use at the foreign host. Since this file is not
encrypted, the automatic login feature is not available when your AIX system
has been configured with the securetcpip command.
<p><a name=index1488>The</a> rcp command and the rshd server (daemon) can be
used to transfer files between AIX systems. They provide two additional
features: copying file attributes and copying recursively subdirectory files.
Since rcp and rshd do not provide a secure environment for transferring files,
they are disabled by running the securetcpip command.
<p>The securetcpip command is used to enable additional security environments
by disabling commands that are not trusted. For more information about the
securetcpip command, please refer to <i>AIX Version 3.2 for RISC System/6000
Communication Concepts and Procedures</i>.

<h4><a name="H476">4.4.6.5  AIX/ESA</a>
</h4>
<p>Both the FTP client and server functions are provided in AIX/ESA. In
addition, the rcp command may also be used, if your local system is listed in
the /etc/hosts.equiv file on the remote system; or, your system and your user
name are listed in the .rhosts file in your home directory on the remote
system.
<p><b>Note:</b> Any copy operation is subject to the AIX/ESA security features
in effect. For more details, please refer to <i>AIX/ESA Security Features
User's Guide</i>.

<h4><a name="H477">4.4.6.6  OS/2</a>
</h4>
<p>TCP/IP for OS/2 implements both the client and server functions of FTP.
<p>Two files are used by the FTP to enable or automate various functions. These
files are:
<ul>
<li>TRUSERS - Used by the FTP server to define access authorization to users on
the foreign host. You can assign user IDs, passwords, and authority (read or
write) on a directory basis.
<p>Here is an example of a TRUSERS file:
<pre>
user: bill buffalo
rd:   d:\
wr:   d:\tmp

user: jane calamity
wr^: c:\etc
</pre>
<p>Where:
<ul>
<li><tt>bill</tt> is the user ID
<li><tt>buffalo</tt> is his password
<li><tt>rd:  d:\</tt> allows Bill to read any file whose access path begins
with d:\.
<li><tt>wr:  d:\tmp</tt> allows Bill to write into any file whose access path
begins with d:\tmp.
</ul>
<ul>
<li><tt>jane</tt> is the user ID
<li><tt>calamity</tt> is her password
<li><tt>wr^:  c:\etc</tt> gives Jane access to read or write to
any file except those whose access path begin with c:\etc.
</ul>
<li>NETRC - Used by FTP clients as a source for user ID and password values and
macros (the init macro is the one that executes when the session is
established).
</ul>
<p>Here is an example of NETRC file:
<pre>
machine fsc5 login debulois password xxxxxx macdef init
pwd

macdef go
lcd c:\work
binary
hash
put miam.miam crunch.crunch

machine reso login debulois password yyyyyyy macdef init
pwd

</pre>
<p>When the command <tt>FTP fsc5</tt> is issued the following sequence takes
place:
<ol>
<li>The NETRC file is read from the line <tt>machine fsc5</tt>
<li>The password and user ID are transmitted to the server
<li>The init macro is executed (that is, the pwd FTP subcommand is executed)
and control is returned to the keyboard
<li>The go macro can be executed under the FTP command prompt.
</ol>
<p>The FTP -n fsc5 command allows you to log on to the host named fsc5 without
reading the NETRC file.
<p>These two files can be hidden by the File Manager and their location can be
customized.
<p>A Presentation Manager FTP client application is also provided (FTPPM).
<p>The FTP server can be initiated by the INETD super server or by the ftpd
command.
<p>The High Performance File System (HPFS) is supported.
<p>TCP/IP for OS/2 also includes an API that allows applications to have a
client interface for file transfer. Applications written to this interface can
communicate with multiple FTP servers at the same time (256 connections
maximum). The interface also allows third-party proxy transfers between pairs
of FTP servers. In addition to the FTP specific API calls, a ping() call is
included to allow the application to determine whether the remote host is alive
before attempting FTP transfers. The programs may be compiled and linked using
the IBM C-Set/2 32-bit compiler or alternatively, the Microsoft C Compiler
Version 6.0A.
<p>The REXX FTP Application Program Interface (API) package, which is provided
in the TCP/IP V2.0 for OS/2 Base Kit, provides access to the OS/2 TCP/IP FTP
APIs. The REXX FTP API function names are similar to the FTP subcommands.

<h4><a name="H478">4.4.6.7  DOS</a>
</h4>
<p>TCP/IP for DOS implements both the client and server functions of FTP.  In
particular, a DOS-based FTP server and client are provided as well as a
Windows-based FTP client.
<p>The FTP server function is implemented as a dedicated, foreground process
and can support multiple concurrent FTP client sessions. It supports DOS wild
card characters for multiple file transfers. Its security function is similar
to that of the OS/2 implementation of a trusted users file named TRUSERS.
<p>Once in the FTP command shell (<tt>ftp&gt;</tt>) you can (basic FTP
subcommands not included):
<ul>
<li>Enter DOS command with the <tt>!</tt> subcommand
<li>Reserve space on the host to accommodate the file to be transferred with
the allocate subcommand
<li>Transfer a single file from a host and append it to a file on your PC with
the getappend subcommand
<li>Read the FTP subcommands from a file on your PC with the take subcommand
<li>Inform the FTP server that your byte-size is eight bits with the tenex
subcommand
</ul>
<p>A file transfer from TCP/IP for DOS can be automated using a command file
with the ftp -f command_file command.
<p>TCP/IP for DOS also includes an API which allows applications to have a
client interface for file transfer. Applications written to this interface can
communicate with multiple FTP servers at the same time (256 connections
maximum). The interface also allows third-party proxy transfers between pairs
of FTP servers. In addition to the FTP specific API calls, a ping() call is
included to allow the application to determine whether the remote host is alive
before attempting FTP transfers.

<p><a href="./3376fm.html"><img src="fm2html-toc.gif">Table of Contents</a>  <a href="3376c45.html#namesrv"><img src="fm2html-next.gif">Domain
Name System (DNS)</a><br>
</html>
