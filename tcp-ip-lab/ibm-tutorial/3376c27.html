<!-- output file generated by BM Utilities -->
<html>

<p><a href="./3376fm.html"><img src="fm2html-toc.gif">Table of Contents</a>  <a href="3376c26.html#tracert"><img src="fm2html-previous.gif">Traceroute</a><br>
<head>
<title>
TCP/IP Tutorial and Technical Overview
</title>
<body>

<h2><a name="igmp">2.7  Internet Group Management Protocol (IGMP)</a>
</h2>
<p><a name=index842>IGMP</a> is a <i>standard protocol</i> with STD number 5
which also includes IP (see <a href="3376c23.html#ip">Internet Protocol
(IP)</a>) and ICMP (see <a href="3376c24.html#icmp">Internet Control Message
Protocol (ICMP)</a>). <a name=index843>Its</a> status is <i>recommended</i> and
it is described in RFC 1112.
<p><b>Note:</b> IP and ICMP are <i>required</i>.
<p><a name=index844>IGMP</a> is best regarded as an extension to ICMP and
occupies the same place in the IP protocol stack.
<a href=3376footnotes.html#footnote3>(3)</a>
<p>See <a href="3376c22.html#multic">Multicasting</a> for an introduction to
multicasting.

<h3><a name="H164">2.7.1  IGMP Messages</a>
</h3>
<p>ICMP messages are sent in IP datagrams. The IP header will always have a
Protocol number of 2, indicating IGMP and a Type of Service of zero (routine).
The IP data field will contain the 8-byte IGMP message in the format shown in
<a href="3376c27.html#figigmpfmt">Figure - ICMP Message Format</a>.
<br><br><a name=figigmpfmt>
<img src="3376f36.gif"></a>
<br><i>Figure: ICMP Message Format</i><br><br>
<a name=index845>Where</a>:
<dl>
<dt>
Vers
<dd>4-bit IP version. Always 1.
<dt>
Type
<dd>Specifies a query or a report.
<dl>
<dt>
1
<dd>Specifies a query sent by a multicast router.
<dt>
2
<dd>Specifies a report sent by a host.
</dl>
<dt>
Checksum
<dd><a name=index847>A</a> 16-bit checksum calculated as for ICMP.
<dt>
Class D Address
<dd>This is zero for a request, and is a valid multicast group address for a
report.
</dl>

<h3><a name="H166">2.7.2  IGMP Operation</a>
</h3>
<p>Systems participating in IGMP fall into two types: hosts and multicast
routers.
<p>As described in <a href="3376c22.html#multic">Multicasting</a>, in order to
receive multicast datagrams, a host must join a host group. When a host is
multi-homed, it may join any group on one or more of its interfaces (attached
subnets). The multicast messages that the host receives from the same group on
two different subnets may be different. For example 244.0.0.1 is the group for
``all hosts on this subnet'', so the messages received on one subnet will
always be different for this group from those on another.
<a name=index848>Multiple</a> processes on a single host may be listening for
messages for a multicast group on a subnet. If this is the case, the host joins
the group once only, and keeps track internally of which processes are
interested in that group.
<p>To join a group, the host sends a report on an interface.
<a name=index849>The</a> report is addressed to the multicast group of
interest. Multicast routers on the same subnet receive the report and set a
flag to indicate that at least one host on that subnet is a member of that
group. No host has to join the all hosts group (224.0.0.1); membership is
automatic. Multicast routers have to listen to all multicast addresses (that
is, all groups) in order to detect such reports. The alternatives would be to
use broadcasts for reports or to configure hosts with unicast addresses for
multicast routers.
<p>Multicast routers regularly, but infrequently (RFC 1112 mentions one-minute
intervals), send out a query to the all hosts multicast address.
<a name=index850>Each</a> host which still wishes to be a member of one or more
groups replies once for each group of interest (but never the all hosts group,
since membership is automatic). Each reply is sent after a random delay to
ensure that IGMP does not cause bursts of traffic on the subnet. Since routers
do not care how many hosts are members of a group and since all hosts which are
members of that group can hear each other replying, any host which hears
another claim membership of a group will cancel any reply that it is due to
send in order to avoid wasting resources. If no hosts claim membership of a
group within a specified interval, the multicast router decides that no host is
a member of the group. When a host or a multicast router receives a multicast
datagram, its action is dependent upon the TTL value and the destination IP
address.
<dl>
<dt>
<a name=index851>0</a>
<dd>A datagram sent with a TTL value of zero is restricted to the source host.
<dt>
1
<dd>A datagram with a TTL value of one reaches all hosts on the subnet which
are members of the group. Multicast routers decrement the value to zero, but
unlike unicast datagrams, they do not report this with an ICMP Time Exceeded
message. Expiration of a multicast datagram is a normal occurrence.
<dt>
2+
<dd>All hosts which are members of the group and all multicast routers receive
the datagram. The action of the routers depends on the multicast group address.
<dl>
<dt>
224.0.0.0 - 224.0.0.255
<dd><a name=index852>This</a> range is intended for single-hop multicasting
applications only. Multicast routers will not forward datagrams with
destination IP addresses in this range.
<p>It may seem at first as though a host need not bother reporting its
membership of a group in this range since multicast routers will not forward
datagrams from other subnets. However, the report also informs other hosts on
the subnet that the reporting host is a member if the group. The only group
which is never reported is 224.0.0.1 because all hosts know that the group
consists of all hosts on that subnet.
<dt>
other
<dd>Datagrams with other values for the destination address are forwarded as
normal by the multicast router: it decrements the TTL value by at least one
second as usual.
<p>This allows a host to locate the nearest server which is listening on a
multicast address using what is called an <i>expanding ring search</i>.
<a name=index853>The</a> host sends out a datagram with a TTL value of 1 (same
subnet) and waits for a reply. If none is received, it tries a TTL value of 2,
then 3, and so on. Eventually it will find the closest server.
<a href=3376footnotes.html#footnote4>(4)</a>
</dl>
</dl>

<p><a href="./3376fm.html"><img src="fm2html-toc.gif">Table of Contents</a>  <a href="3376c28.html#arp"><img src="fm2html-next.gif">Address
Resolution Protocol (ARP)</a><br>
</html>
