<!-- output file generated by BM Utilities -->
<html>

<p><a href="./3376fm.html"><img src="fm2html-toc.gif">Table of Contents</a>  <a href="3376c29.html#H190"><img src="fm2html-previous.gif">RARP
Concept</a><br>
<head>
<title>
TCP/IP Tutorial and Technical Overview
</title>
<body>

<h2><a name="sokapi">2.10  Ports and Sockets</a>
</h2>
<p>In this section we will introduce the concepts of <i>port</i> and
<i>socket</i>.

<h3><a name="H192">2.10.1  Ports</a>
</h3>
<p><a name=index898>Each</a> <i>process</i> that wants to communicate with
another process identifies itself to the TCP/IP protocol suite by one or more
<i>ports</i>. A port is a 16-bit number, used by the host-to-host protocol to
identify to which higher-level protocol or application program (process) it
must deliver incoming messages.
<p>As some higher-level programs are themselves protocols, standardized in the
TCP/IP protocol suite, such as TELNET and FTP, they use the same port number in
all TCP/IP implementations. Those "assigned" <a name=index899>port</a> numbers
are called <i>well-known ports</i> and the standard
<a name=index900>applications</a> <i>well-known services</i>.
<p>The "well-known" ports are controlled and assigned by the Internet Assigned
Numbers Authority (IANA) and on most systems can only be used by system
processes or by programs executed by privileged users. The assigned
"well-known" ports occupy port numbers in the range 0 to 1023. The ports with
numbers in the range 1024-65535 are not controlled by the IANA and on most
systems can be used by ordinary user-developed programs.
<p>Confusion due to two different applications trying to use the same port
numbers on one host is avoided by writing those applications to request an
available port from TCP/IP. Because this port number is dynamically assigned,
it may differ from one invocation of an application to the next.
<p>UDP, TCP and ISO TP-4 all use the same "port principle". (Please see
<a href="3376c211.html#figudpport">Figure - UDP, A Demultiplexer Based on
Ports</a> and <a href="3376c212.html#figtcpf1">Figure - TCP Connection</a>.) To
the extent possible, the same port numbers are used for the same services on
top of UDP, TCP and ISO TP-4.

<h3><a name="H193">2.10.2  Sockets</a>
</h3>
<p><a name=index901>Let</a> us first consider the following terminologies:
<ul>
<li>A <i>socket</i> is a special type of <i>file handle</i> which is used by a
process to request network services from the operating system.
<li><a name=index902>A</a> <i>socket address</i> is the triple:
<p>     {<i>protocol, local-address, local-process</i>}
<p>In the TCP/IP suite, for example:
<p>     {<i>tcp, 193.44.234.3, 12345</i>}
<li><a name=index903>A</a> <i>conversation</i> is the communication link
between two processes.
<li><a name=index904>An</a> <i>association</i> is the 5-tuple that completely
specifies the two processes that comprise a connection:
<p>     {<i>protocol, local-address, local-process, foreign-address,
foreign-process</i>}
<p>In the TCP/IP suite, for example:
<p>     {<i>tcp, 193.44.234.3, 1500, 193.44.234.5, 21</i>}
<p>could be a valid association.
<li><a name=index905>A</a> <i>half-association</i> is either:
<p>     {<i>protocol, local-address, local-process</i>}
<p>or
<p>     {<i>protocol, foreign-address, foreign-process</i>}
<p>which specify each half of a connection.
<li>The half-association is also called a <i>socket</i> or a <i>transport
address</i><a name=index906>.</a> That is, a socket is an end point for
communication that can be named and addressed in a network.
</ul>
<p><a name=index908>The</a> socket interface is one of several <i>application
programming interfaces (APIs)</i> to the communication protocols. Designed to
be a generic communication programming interface, it was first introduced by
the 4.2BSD UNIX system. Although it has not been standardized, it has become a
<i>de facto</i> industry standard.
<p>4.2BSD allowed two different communication domains: Internet and UNIX.
4.3BSD has added the Xerox Network System (XNS) protocols and 4.4BSD will add
an extended interface to support the ISO OSI protocols.

<h3><a name="H194">2.10.3  Basic Socket Calls</a>
</h3>
<p>The following lists some basic socket interface calls. In the next section
we shall see an example scenario of using these socket interface calls.
<ul>
<li>Initialize a socket
<p>FORMAT: int <i>sockfd</i> = <b>socket</b>(int <i>family</i>, int
<i>type</i>, int <i>protocol</i>)
<p>where:
<ul>
<li><i>family</i> stands for <i>addressing family</i>. It can take on values
such as AF_UNIX, AF_INET, AF_NS and AF_IUCV. Its purpose is to specify the
method of addressing used by the socket.
<li><i>type</i> stands for the type of socket interface to be used. It can take
on values such as SOCK_STREAM, SOCK_DGRAM, SOCK_RAW, and SOCK_SEQPACKET.
<li><i>protocol</i> can be UDP, TCP, IP or ICMP.
<li><i>sockfd</i> is an integer (similar to a file descriptor) returned by the
<b>socket</b> call.
</ul>
<li>Bind (Register) a socket to a port address
<p>FORMAT: int <b>bind</b>(int <i>sockfd</i>, struct sockaddr
<i>*localaddr</i>, int <i>addrlen</i>)
<p>where:
<ul>
<li><i>sockfd</i> is the same integer returned by the <b>socket</b> call.
<li><i>localaddr</i> is the local address returned by the <b>bind</b> call.
</ul>
Note that after the <b>bind</b> call, we now have values for the first three
parameters inside our 5-tuple association:
<p>     {<i>protocol, local-address, local-process, foreign-address,
foreign-process</i>}
<li>Indicate readiness to receive connections
<p>FORMAT: int <b>listen</b>(int <i>sockfd</i>, int <i>queue-size</i>)
<p>where:
<ul>
<li><i>sockfd</i> is the same integer returned by the <b>socket</b> call.
<li><i>queue-size</i> indicates the number of connection requests which can be
queued by the system while the local process has not yet issued the
<b>accept</b> call.
</ul>
<li>Accept a connection
<p>FORMAT: int <b>accept</b>(int <i>sockfd</i>, struct sockaddr
<i>*foreign-address</i>, int <i>addrlen</i>)
<p>where:
<ul>
<li><i>sockfd</i> is the same integer returned by the <b>socket</b> call.
<li><i>foreign-address</i> is the address of the foreign (client) process
returned by the <b>accept</b> call.
</ul>
<p>Note that this <b>accept</b> call is issued by a server process rather than
a client process. If there is a connection request waiting on the queue for
this socket connection, <b>accept</b> takes the first request on the queue and
creates another socket with the same properties as <i>sockfd</i>; otherwise,
<b>accept</b> will block the caller process until a connection request arrives.
<li>Request connection to the server
<p>FORMAT: int <b>connect</b>(int <i>sockfd</i>, struct sockaddr
<i>*foreign-address</i>, int <i>addrlen</i>)
<p>where:
<ul>
<li><i>sockfd</i> is the same integer returned by the <b>socket</b> call.
<li><i>foreign-address</i> is the address of the foreign (server) process
returned by the <b>connect</b> call.
</ul>
<p>Note that this call is issued by a client process rather than a server
process.
<li>Send and/or receive data
<p>The <b>read</b>(), <b>readv</b>(<i>sockfd</i>, char <i>*buffer</i>, int
<i>addrlen</i>), <b>recv</b>(), <b>readfrom</b>(), <b>send</b>(<i>sockfd, msg,
len, flags</i>), <b>write</b>() calls can be used to receive and send data in
an established socket association (or connection).
<p>Note that these calls are similar to the standard <b>read</b> and
<b>write</b> file I/O system calls.
<li>Close a socket
<p>FORMAT: int <b>close</b>(int <i>sockfd</i>)
<p>where:
<ul>
<li><i>sockfd</i> is the same integer returned by the <b>socket</b> call.
</ul>
</ul>
<p>For more details, please refer to [Stevens] and the product implementation
manuals listed in <a href="3376ax1.html#relpubs">Bibliography</a>.

<h3><a name="H195">2.10.4  An Example Scenario</a>
</h3>
<p>As an example, consider the socket system calls for a connection-oriented
protocol.
<br><br><a name=fig>
<img src="3376f44.gif"></a>
<br><i>Figure: Socket System Calls for Connection-Oriented Protocol</i><br><br>
<p><a name=index909>Consider</a> the previous socket system calls in terms of
specifying the elements of the association:
<br><br><a name=fig>
<img src="3376f45.gif"></a>
<br><i>Figure: Socket System Calls and Association</i><br><br>
<p>The socket interface is differentiated by the different services that are
provided. Stream, datagram, and raw sockets each define a different service
available to applications.
<ul>
<li><b>Stream socket interface</b> <a name=index910>(SOCK_STREAM)</a>: It
defines a reliable connection-oriented service (over TCP for example). Data is
sent without errors or duplication and is received in the same order as it is
sent. Flow control is built-in to avoid data overruns. No boundaries are
imposed on the exchanged data, which is considered to be a stream of bytes. An
example of an application that uses stream sockets is the File Transfer Program
(FTP).
<li><b>Datagram socket interface</b> (SOCK_DGRAM): It defines a
<a name=index911>connectionless</a> service (over UDP for example). Datagrams
are sent as independent packets. The service provides no guarantees; data can
be lost or duplicated, and datagrams can arrive out of order. No disassembly
and reassembly of packets is performed. An example of an application that uses
datagram sockets is the Network File System (NFS).
<li><b>Raw socket interface</b> (SOCK_RAW): It allows direct access
<a name=index912>to</a> lower-layer protocols such as IP and ICMP. This
interface is often used for testing new protocol implementations. An example of
an application that uses raw sockets is the Ping command.
</ul>

<h3><a name="H198">2.10.5  Implementations</a>
</h3>
<p>In this section we discuss how sockets are implemented in the IBM TCP/IP
products.

<h4><a name="H199">2.10.5.1  VM and MVS</a>
</h4>
<p>The socket implementation in TCP/IP for VM and MVS supports two addressing
families: <i>AF_INET</i>, and <i>AF_IUCV</i>. The AF_INET domain defines
addressing in the Internet domain. The AF_IUCV domain
<a name=index913>defines</a> addressing in the IUCV domain. In the IUCV domain,
address spaces or virtual machines can use the socket interface to communicate
with other virtual machines or address spaces within the same operating system.
Only stream sockets are supported in the AF_IUCV domain.
<p>In an MVS OpenEdition environment AF_UNIX sockets are also supported.

<h4><a name="H200">2.10.5.2  OS/2 and DOS</a>
</h4>
<p>TCP/IP for OS/2 and TCP/IP for DOS both support the <i>AF_INET</i>
addressing family.  They both support the Stream and Datagram socket
interfaces.

<h4><a name="H201">2.10.5.3  AIX</a>
</h4>
<p>All AIX implementations support the <i>AF_INET</i> and <i>AF_UNIX</i>
addressing families.
<p>They all support the 4.3BSD sockets and the datagram and stream socket
interfaces.

<p><a href="./3376fm.html"><img src="fm2html-toc.gif">Table of Contents</a>  <a href="3376c211.html#udpf1"><img src="fm2html-next.gif">User
Datagram Protocol (UDP)</a><br>
</html>
